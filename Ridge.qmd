---
title: "Chapter 9: Ridge Regression"
format: html
toc: true
number-sections: true
---

## Basic Setup

load the required library. And load the data.

```{r}
#| warning: false 
#| message: false

library(glmnet)

cigarette_data <- data.frame(
  Brand = c("Alpine", "Benson & Hedges", "Bull Durham", "Camel Lights", "Carlton", 
           "Chesterfield", "Golden Lights", "Kent", "Kool", "L&M", 
           "Lark Lights", "Marlboro", "Merit", "Multifilter", "Newport Lights", 
           "Now", "Old Gold", "Pall Mall Light", "Raleigh", "Salem Ultra", 
           "Tareyton", "True", "Viceroy Rich Lights", "Virginia Slims", "Winston Lights"),
  Tar = c(14.1, 16.0, 29.8, 8.0, 4.1, 15.0, 8.8, 12.4, 16.6, 14.9, 
          13.7, 15.1, 7.8, 11.4, 9.0, 1.0, 17.0, 12.8, 15.8, 4.5, 
          14.5, 7.3, 8.6, 15.2, 12.0),
  Nicotine = c(0.86, 1.06, 2.03, 0.67, 0.40, 1.04, 0.76, 0.95, 1.12, 1.02, 
               1.01, 0.90, 0.57, 0.78, 0.74, 0.13, 1.26, 1.08, 0.96, 0.42, 
               1.01, 0.61, 0.69, 1.02, 0.82),
  Weight = c(0.9853, 1.0938, 1.1650, 0.9280, 0.9462, 0.8885, 1.0267, 0.9225, 0.9372, 0.8858, 
             0.9643, 0.9316, 0.9705, 1.1240, 0.8517, 0.7851, 0.9186, 1.0395, 0.9573, 0.9106, 
             1.0070, 0.9806, 0.9693, 0.9496, 1.1184),
  Carbon_Monoxide = c(13.6, 16.6, 23.5, 10.2, 5.4, 15.0, 9.0, 12.3, 16.3, 15.4, 
                      13.0, 14.4, 10.0, 10.2, 9.5, 1.5, 18.5, 12.6, 17.5, 4.9, 
                      15.9, 8.5, 10.6, 13.9, 14.9)
)

```

## Prepare the data for ridge regression


```{r}

x <- cigarette_data[, c("Tar", "Nicotine", "Weight")]

y <- cigarette_data$Carbon_Monoxide

```

## Fit ridge regression model

use the x and y data from above, together with alpha = 0 and lambda = 0.48

```{r}

ridge_model <- glmnet(x, y, alpha = 0, lambda = 0.48)

```

## Get the ridge parameter estimates

```{r}

ridge_coef <- coef(ridge_model)

print(ridge_coef)

```

## Compare with Ordinary Least Squares (OLS)

```{r}

ols_model <- lm(Carbon_Monoxide ~ Tar + Nicotine + Weight, data = cigarette_data)

print(coef(ols_model))

print(ridge_coef)

```

## Check correlation matrix to understand multi collinearity

```{r}
correlation_matrix <- cor(x)

print(correlation_matrix)

```
