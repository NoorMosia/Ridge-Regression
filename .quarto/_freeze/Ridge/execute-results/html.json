{
  "hash": "c6e0be38be70d192bb651512505689a1",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Chapter 9: Ridge Regression\"\nformat: html\ntoc: true\nnumber-sections: true\n---\n\n\n\n## Basic Setup\n\nload the required library. And load the data.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(glmnet)\n\ncigarette_data <- data.frame(\n  Brand = c(\"Alpine\", \"Benson & Hedges\", \"Bull Durham\", \"Camel Lights\", \"Carlton\", \n           \"Chesterfield\", \"Golden Lights\", \"Kent\", \"Kool\", \"L&M\", \n           \"Lark Lights\", \"Marlboro\", \"Merit\", \"Multifilter\", \"Newport Lights\", \n           \"Now\", \"Old Gold\", \"Pall Mall Light\", \"Raleigh\", \"Salem Ultra\", \n           \"Tareyton\", \"True\", \"Viceroy Rich Lights\", \"Virginia Slims\", \"Winston Lights\"),\n  Tar = c(14.1, 16.0, 29.8, 8.0, 4.1, 15.0, 8.8, 12.4, 16.6, 14.9, \n          13.7, 15.1, 7.8, 11.4, 9.0, 1.0, 17.0, 12.8, 15.8, 4.5, \n          14.5, 7.3, 8.6, 15.2, 12.0),\n  Nicotine = c(0.86, 1.06, 2.03, 0.67, 0.40, 1.04, 0.76, 0.95, 1.12, 1.02, \n               1.01, 0.90, 0.57, 0.78, 0.74, 0.13, 1.26, 1.08, 0.96, 0.42, \n               1.01, 0.61, 0.69, 1.02, 0.82),\n  Weight = c(0.9853, 1.0938, 1.1650, 0.9280, 0.9462, 0.8885, 1.0267, 0.9225, 0.9372, 0.8858, \n             0.9643, 0.9316, 0.9705, 1.1240, 0.8517, 0.7851, 0.9186, 1.0395, 0.9573, 0.9106, \n             1.0070, 0.9806, 0.9693, 0.9496, 1.1184),\n  Carbon_Monoxide = c(13.6, 16.6, 23.5, 10.2, 5.4, 15.0, 9.0, 12.3, 16.3, 15.4, \n                      13.0, 14.4, 10.0, 10.2, 9.5, 1.5, 18.5, 12.6, 17.5, 4.9, \n                      15.9, 8.5, 10.6, 13.9, 14.9)\n)\n```\n:::\n\n\n\n## Prepare the data for ridge regression\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx <- cigarette_data[, c(\"Tar\", \"Nicotine\", \"Weight\")]\n\ny <- cigarette_data$Carbon_Monoxide\n```\n:::\n\n\n\n## Fit ridge regression model\n\nuse the x and y data from above, together with alpha = 0 and lambda = 0.48\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nridge_model <- glmnet(x, y, alpha = 0, lambda = 0.48)\n```\n:::\n\n\n\n## Get the ridge parameter estimates\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nridge_coef <- coef(ridge_model)\n\nprint(ridge_coef)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n4 x 1 sparse Matrix of class \"dgCMatrix\"\n                   s0\n(Intercept) 1.8840216\nTar         0.4802477\nNicotine    4.3169666\nWeight      1.0243211\n```\n\n\n:::\n:::\n\n\n\n## Compare with Ordinary Least Squares (OLS)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nols_model <- lm(Carbon_Monoxide ~ Tar + Nicotine + Weight, data = cigarette_data)\n\nprint(coef(ols_model))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n(Intercept)         Tar    Nicotine      Weight \n  3.2021900   0.9625739  -2.6316611  -0.1304819 \n```\n\n\n:::\n\n```{.r .cell-code}\nprint(ridge_coef)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n4 x 1 sparse Matrix of class \"dgCMatrix\"\n                   s0\n(Intercept) 1.8840216\nTar         0.4802477\nNicotine    4.3169666\nWeight      1.0243211\n```\n\n\n:::\n:::\n\n\n\n## Check correlation matrix to understand multi collinearity\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncorrelation_matrix <- cor(x)\n\nprint(correlation_matrix)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n               Tar  Nicotine    Weight\nTar      1.0000000 0.9766076 0.4907654\nNicotine 0.9766076 1.0000000 0.5001827\nWeight   0.4907654 0.5001827 1.0000000\n```\n\n\n:::\n:::\n",
    "supporting": [
      "Ridge_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}